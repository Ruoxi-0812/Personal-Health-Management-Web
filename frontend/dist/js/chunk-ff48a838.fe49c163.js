(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ff48a838"],{"25a9":function(t,e,s){"use strict";function o(t){const e=new Date,s=new Date(t),o=(e.getTime()-s.getTime())/1e3;if(o<60)return Math.floor(o)+" seconds ago";if(o<3600)return Math.floor(o/60)+" minutes ago";if(o<=86400)return Math.floor(o/3600)+" hours ago";{const t=Math.floor(o/86400);return 1===t?"1 day ago":t+" days ago"}}s.d(e,"a",(function(){return o}))},"288f":function(t,e,s){},"3ba9":function(t,e,s){},"48ab":function(t,e,s){"use strict";s("3ba9")},"745c":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t._self._c;return e("el-row",{staticStyle:{width:"1000px",margin:"0 auto"}},[e("el-col",{attrs:{span:16}},[e("div",{staticStyle:{"padding-right":"50px","box-sizing":"border-box"}},[e("div",[e("h1",[t._v(t._s(t.newsInfo.name))]),e("div",{staticStyle:{"font-size":"12px","background-color":"rgb(250, 250, 250)",padding:"16px 6px","border-radius":"5px"}},[e("span",{staticClass:"news-tags"},[t._v(t._s(t.newsInfo.tagName))]),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.parseTime(t.newsInfo.createTime)))]),e("el-button",{staticClass:"customer",staticStyle:{"margin-left":"20px"},attrs:{size:"mini"},on:{click:t.saveNewsOperation}},[t._v(t._s(t.saveFlag?"Unsave":"Save Now"))])],1),e("div",{domProps:{innerHTML:t._s(t.newsInfo.content)}})]),e("div",[e("Evaluations",{attrs:{contentId:t.newsInfo.id,contentType:"NEWS"}})],1)])]),e("el-col",{attrs:{span:8}},[e("h3",{staticStyle:{padding:"10px 30px"}},[t._v("Recommended News")]),t._l(t.newsTopList,(function(s,o){return e("el-col",{key:o,attrs:{span:24},nativeOn:{click:function(e){return t.newsItemClick(s)}}},[e("div",{staticStyle:{padding:"25px 30px","box-sizing":"border-box"}},[e("img",{staticStyle:{width:"100%",height:"118px","border-radius":"5px"},attrs:{src:s.cover,alt:s.name}}),e("h3",{staticClass:"news-title"},[t._v(t._s(s.name))]),e("div",{staticStyle:{"font-size":"12px"}},[e("span",{staticClass:"news-tags"},[t._v(t._s(s.tagName))]),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.parseTime(s.createTime)))])])])])}))],2)],1)},n=[],i=s("25a9"),a=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"100%"}},[e("el-row",{staticStyle:{margin:"5px 0"}},[e("h2",{staticClass:"commentHeader"},[t._v("comment "+t._s(t.evaluationsCount))]),e("el-row",{staticStyle:{margin:"15px 0"}},[e("el-col",{attrs:{span:2}},[e("el-avatar",{attrs:{src:t.userData.userAvatar}})],1),e("el-col",{attrs:{span:22}},[e("div",{staticClass:"parent-comment",style:{backgroundColor:t.bgColor,height:t.isFocused?"120px":"70px",borderColor:t.isFocused?"#007bff":"transparent"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"comment-parent-input",attrs:{placeholder:"Please friendly communication"},domProps:{value:t.content},on:{focus:t.onFocus,blur:t.onBlur,input:function(e){e.target.composing||(t.content=e.target.value)}}}),e("div",[e("span",{staticClass:"comment-input-number"},[t._v(t._s(t.content.length)+" / 300")]),e("el-button",{staticClass:"comment-clike",style:{backgroundColor:t.isFocused?"#007bff":"#666",borderColor:t.isFocused?"#007bff":"#666"},attrs:{size:"mini",type:"primary"},on:{click:t.commentClick}},[t._v("Comment")])],1)])])],1)],1),e("el-row",{staticStyle:{margin:"5px 0px"}},t._l(t.commentList,(function(s,o){return e("el-row",{key:o,staticStyle:{padding:"10px 0"}},[e("el-row",[e("el-col",{attrs:{span:2}},[e("el-avatar",{attrs:{size:"large",src:s.userAvatar}})],1),e("el-col",{attrs:{span:22}},[e("span",{staticStyle:{height:"40px","line-height":"40px","font-size":"16px",color:"#515767"}},[t._v(t._s(s.userName))]),s.userId==t.userId?e("span",{staticClass:"my-body-tag"},[t._v("Myself")]):t._e()])],1),e("el-row",{staticStyle:{padding:"8px 0"}},[e("el-col",{attrs:{span:22,offset:2}},[e("span",{staticStyle:{"font-size":"16px",color:"#252933"}},[t._v(t._s(s.content))])])],1),e("el-row",{staticStyle:{padding:"8px 0"}},[e("el-col",{attrs:{span:22,offset:2}},[e("span",{staticStyle:{"font-size":"14px",color:"#8A919F"}},[t._v(t._s(s.time))]),s.userId==t.userId?e("el-popconfirm",{attrs:{"confirm-button-text":"OK","cancel-button-text":"Don not delete",icon:"el-icon-info","icon-color":"red",title:"Delete this comment?"},on:{confirm:function(e){return t.deleteComment(s)}}},[e("span",{staticStyle:{cursor:"pointer","margin-left":"15px","font-size":"14px",color:"#8A919F","user-select":"none"},attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"el-icon-delete"}),t._v(" Delete ")])]):t._e(),e("span",{staticStyle:{cursor:"pointer","margin-left":"15px","font-size":"14px",color:"#8A919F","user-select":"none"},on:{click:function(e){return t.toggleReplyInput(s)}}},[e("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" Reply"),0!=s.childTotal?e("span",[t._v("("+t._s(s.childTotal)+")")]):t._e()]),e("span",{staticStyle:{cursor:"pointer","margin-left":"15px","font-size":"14px",color:"#8A919F","user-select":"none"},on:{click:function(e){return t.upvote(s)}}},[s.upvoteFlag?e("i",{staticClass:"el-icon-discount",staticStyle:{color:"#1E80FF"}},[t._v(" "+t._s(s.upvoteCount))]):e("i",{staticClass:"el-icon-discount"},[t._v("Like")])])],1)],1),s.showReplyInput?e("el-row",{staticStyle:{padding:"10px 0"}},[e("el-col",{attrs:{span:22,offset:2}},[e("div",{staticClass:"parent-comment",style:{backgroundColor:t.bgColor,height:"110px",borderColor:"#007bff"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.replyContent,expression:"replyContent"}],staticClass:"comment-parent-input",attrs:{placeholder:t.replyText},domProps:{value:t.replyContent},on:{input:function(e){e.target.composing||(t.replyContent=e.target.value)}}}),e("div",[e("span",{staticClass:"comment-input-number"},[t._v(t._s(t.replyContent.length)+" / 300")]),e("el-button",{staticClass:"comment-clike",staticStyle:{"background-color":"#007bff","user-select":"none"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.submitReply(s)}}},[t._v("Comment")])],1)])])],1):t._e(),t._l(s.commentChildVOS,(function(s,o){return e("el-row",{key:o,staticStyle:{padding:"10px 15px","font-size":"16px"}},[e("el-row",[e("el-col",{attrs:{span:22,offset:2}},[e("el-row",{staticStyle:{display:"flex","align-items":"center","flex-wrap":"wrap"}},[e("el-avatar",{staticStyle:{"margin-right":"5px"},attrs:{size:"small",src:s.userAvatar}}),e("span",{staticStyle:{color:"#515767",padding:"0 5px"}},[t._v(t._s(s.userName))]),s.userId==t.userId?e("span",{staticClass:"my-body-tag"},[t._v("Myself")]):t._e(),null!=s.replierName?e("span",{staticStyle:{margin:"0 15px",color:"#1c1c1c","user-select":"none","font-size":"12px"}},[t._v(" Reply ")]):t._e(),null!=s.replierName?e("el-avatar",{staticStyle:{"margin-right":"5px"},attrs:{size:"small",src:s.replierAvatar}}):t._e(),null!=s.replierName?e("span",{staticStyle:{color:"#515767",padding:"0 5px"}},[t._v(t._s(s.replierName))]):t._e(),s.replierId==t.userId?e("span",{staticClass:"my-body-tag"},[t._v("Myself")]):t._e(),e("span",{staticStyle:{"letter-spacing":"1px","font-size":"16px",color:"#252933","white-space":"normal","margin-left":"5px",padding:"6px 0"}},[t._v(" : "+t._s(s.content)+" ")])],1),e("el-row",{staticStyle:{padding:"10px 0"}},[e("span",{staticStyle:{"font-size":"14px",color:"#8A919F"}},[t._v(t._s(s.time))]),s.userId==t.userId?e("el-popconfirm",{attrs:{"confirm-button-text":"OK","cancel-button-text":"Do not Delete",icon:"el-icon-info","icon-color":"red",title:"Delete this comment?"},on:{confirm:function(e){return t.deleteComment(s)}}},[e("span",{staticStyle:{cursor:"pointer","margin-left":"15px","font-size":"14px",color:"#8A919F","user-select":"none"},attrs:{slot:"reference"},slot:"reference"},[e("i",{staticClass:"el-icon-delete"}),t._v(" Delete ")])]):t._e(),e("span",{staticStyle:{cursor:"pointer","margin-left":"15px","font-size":"14px",color:"#8A919F","user-select":"none"},on:{click:function(e){return t.toggleReplyInput1(s)}}},[e("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" Reply ")]),e("span",{staticStyle:{cursor:"pointer","margin-left":"15px","font-size":"14px",color:"#8A919F","user-select":"none"},on:{click:function(e){return t.upvote(s)}}},[s.upvoteFlag?e("i",{staticClass:"el-icon-discount",staticStyle:{color:"#1E80FF"}},[t._v(" "+t._s(s.upvoteCount))]):e("i",{staticClass:"el-icon-discount"},[t._v("Like")])])],1),s.replyInputStatus?e("el-row",{staticStyle:{padding:"10px 0"}},[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"parent-comment",style:{backgroundColor:t.bgColor,height:"110px",borderColor:"#007bff"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.replyChildContent,expression:"replyChildContent"}],staticClass:"comment-parent-input",attrs:{placeholder:t.replyText},domProps:{value:t.replyChildContent},on:{input:function(e){e.target.composing||(t.replyChildContent=e.target.value)}}}),e("div",[e("span",{staticClass:"comment-input-number"},[t._v(t._s(t.replyChildContent.length)+" / 300")]),e("el-button",{staticClass:"comment-clike",staticStyle:{"background-color":"#007bff"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.submitReply1(s)}}},[t._v("评论")])],1)])])],1):t._e()],1)],1)],1)}))],2)})),1),e("el-dialog",{staticStyle:{"user-select":"none","border-radius":"5px"},attrs:{title:"I want to report it.",visible:t.dialogVisibleReport,width:"30%"},on:{"update:visible":function(e){t.dialogVisibleReport=e}}},[t._l(t.reports,(function(s,o){return e("el-row",{key:o,staticStyle:{"margin-top":"10px"}},[e("el-row",{staticStyle:{"padding-bottom":"10px","user-select":"none"}},[t._v("*"+t._s(s.name))]),e("el-row",t._l(s.list,(function(s,o){return e("span",{key:o,on:{click:function(e){return t.reportItemClick(s)}}},[e("button",{staticClass:"reportItem",style:{border:s.isSelected?"1px solid #4b87bc":"1px solid #f4f4f4"}},[t._v(" "+t._s(s.name)+" ")])])})),0)],1)})),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("button",{staticClass:"cannel-btn",on:{click:function(e){t.dialogVisibleReport=!1}}},[t._v("Cancel")]),e("button",{staticClass:"yes-btn",on:{click:t.operationReport}},[t._v("Confirmed report")])])],2)],1)},r=[],l={props:{contentId:{type:Number,default:""},contentType:{type:String,default:""}},data(){return{userData:{},noteData:{},commentContent:"",content:"",commentList:[],replyContent:"",id:null,isFocused:!1,bgColor:"rgb(245 245 245)",strLength:"0/300",replyText:"",userId:"",dialogVisibleReport:!1,reports:[],selectdStatus:!1,evaluationsCount:0,comment:{},replyChildContent:""}},watch:{contentId(t,e){t!==e&&this.loadCommentList()},content(){""!==this.content||(this.isFocused=!1)}},created(){this.getUserInfo(),this.loadCommentList()},methods:{getUserInfo(){const t=sessionStorage.getItem("userInfo");this.userData=JSON.parse(t),this.userId=this.userData.id},upvote(t){const e={id:t.id};this.$axios.put("evaluations/update",e).then(e=>{200==e.data.code&&(console.log(JSON.stringify(e.data.data)),t.upvoteFlag=e.data.data.flag,t.upvoteCount=Number(e.data.data.num))}).catch(t=>{console.error("The like status setting is abnormal -> ",t)})},operationReport(){let t=[];this.reports.forEach(e=>{let s=e.list.filter(t=>t.isSelected);0!=s.length&&(t=s)}),t.length?this.$axios.get(`evaluations-reports/report/${this.comment.id}/${t[0].name}`).then(t=>{this.dialogVisibleReport=!1,200==t.data.code?this.$swal.fire({title:"Reporting operation",text:"Reporting success",icon:"success",showConfirmButton:!1,timer:1100}):this.$swal.fire({title:"Reporting operation",text:t.data.msg,icon:"error",showConfirmButton:!1,timer:1100})}).catch(t=>{console.error("Comment report exception -> ",t)}):this.$message("Please check the report item")},reportItemClick(t){this.reports.forEach(t=>{t.list.forEach(t=>{t.isSelected=!1})}),t.isSelected=!0},reportList(){this.$axios.get("evaluations/reportList").then(t=>{200==t.data.code&&(this.reports=[],t.data.data.forEach(t=>{let e={name:t.name},s=[];t.list.forEach(t=>{let e={};e.name=t,e.isSelected=!1,s.push(e)}),e.list=s,this.reports.push(e)}))}).catch(t=>{console.error("Failed to load the report item -> ",t)})},reportComment(t){this.reportList(),this.dialogVisibleReport=!0,this.comment=t},deleteComment(t){this.$axios.delete("evaluations/delete/"+t.id).then(t=>{200==t.data.code&&(this.$message.success(t.data.msg),this.loadCommentList())}).catch(t=>{console.error("Comment exception -> ",t)})},onFocus(){this.isFocused=!0},onBlur(){""!==this.content?this.isFocused=!0:this.isFocused=!1},commentClick(){if(""==this.content)return void this.$swal.fire({title:"Content prompt",text:"The comments are empty",icon:"success",showConfirmButton:!1,timer:800});const t={contentType:this.contentType,content:this.content,contentId:this.contentId};this.$axios.post("evaluations/insert",t).then(t=>{200==t.data.code?(this.content="",this.$swal.fire({title:"Comment operation",text:"Comment success",icon:"success",showConfirmButton:!1,timer:1100}),setTimeout(()=>{this.loadCommentList()},1100)):this.$swal.fire({title:"Comment exception",text:t.data.msg,icon:"error",showConfirmButton:!1,timer:1100})}).catch(t=>{console.error("Comment exception -> ",t)})},toggleReplyInput(t){this.replyText=`Reply${t.userName}...`,null==t.showReplyInput&&(t.showReplyInput=!1),t.showReplyInput=!t.showReplyInput},toggleReplyInput1(t){null==t.replyInputStatus&&(t.replyInputStatus=!1),t.replyInputStatus=!t.replyInputStatus},submitReply(t){if(""==this.replyContent)return void this.$message("Comments cannot be empty");const e={contentType:this.contentType,content:this.replyContent,contentId:this.contentId,parentId:t.id};this.$axios.post("evaluations/insert",e).then(e=>{200==e.data.code?(this.replyContent="",t.showReplyInput=!1,this.$swal.fire({title:"Reply operation",text:"Reply success",icon:"success",showConfirmButton:!1,timer:1300}),setTimeout(()=>{this.loadCommentList()},1300)):this.$swal.fire({title:"Comment exception",text:e.data.msg,icon:"error",showConfirmButton:!1,timer:1100})}).catch(t=>{console.error("Comment exception -> ",t)})},submitReply1(t){if(""==this.replyChildContent)return void this.$message("Comments cannot be empty");const e={replierId:t.userId,contentType:this.contentType,content:this.replyChildContent,contentId:this.contentId,parentId:t.parentId};this.$axios.post("evaluations/insert",e).then(e=>{200==e.data.code?(this.content="",t.replyInputStatus=!1,this.$swal.fire({title:"Reply operation",text:"Reply success",icon:"success",showConfirmButton:!1,timer:1300}),setTimeout(()=>{this.loadCommentList()},1300)):this.$swal.fire({title:"Comment exception",text:e.data.msg,icon:"error",showConfirmButton:!1,timer:1100})}).catch(t=>{console.error("Comment exception -> ",t)})},goBack(){this.$router.go(-1)},loadCommentList(){this.$axios.get(`evaluations/list/${this.contentId}/${this.contentType}`).then(t=>{200==t.data.code&&(this.commentList=t.data.data.data,this.evaluationsCount=t.data.data.evaluationsCount,this.commentList.forEach(t=>{t.time=Object(i["a"])(t.createTime),t.commentChildVOS.forEach(t=>t.time=Object(i["a"])(t.createTime))}))}).catch(t=>{console.error("Comment query Exception -> ",t)})}}},c=l,p=(s("f256"),s("2877")),u=Object(p["a"])(c,a,r,!1,null,null,null),m=u.exports,d={components:{Evaluations:m},name:"NewsDetail",data(){return{newsInfo:{},newsTopList:[],saveFlag:!1,newsSaveList:[]}},created(){this.getStorageInfo(),this.loadAllTopNews()},methods:{loadSaveStatus(){const t={newsId:this.newsInfo.id};console.log("Query parameters："+JSON.stringify(t)),this.$axios.post("/news-save/queryUser",t).then(t=>{const{data:e}=t;200===e.code&&(this.saveFlag=0!==e.data.length)})},saveNewsOperation(){this.$axios.post("/news-save/operation",{newsId:this.newsInfo.id}).then(t=>{const{data:e}=t;200===e.code&&(this.$message.success(this.saveFlag?"Unsaved Successfully":"Saved Successfully"),this.saveFlag=!this.saveFlag)})},newsItemClick(t){this.newsInfo=t,this.loadSaveStatus()},parseTime(t){return Object(i["a"])(t)},getStorageInfo(){const t=sessionStorage.getItem("newsInfo");this.newsInfo=JSON.parse(t),this.loadSaveStatus()},loadAllTopNews(){const t={isTop:!0};this.$axios.post("/news/query",t).then(t=>{const{data:e}=t;200===e.code&&(this.newsTopList=e.data)})}}},h=d,f=(s("48ab"),Object(p["a"])(h,o,n,!1,null,"1a8bfc9a",null));e["default"]=f.exports},f256:function(t,e,s){"use strict";s("288f")}}]);
//# sourceMappingURL=chunk-ff48a838.fe49c163.js.map